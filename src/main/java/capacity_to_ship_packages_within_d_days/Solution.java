package capacity_to_ship_packages_within_d_days;

import java.util.stream.IntStream;

public class Solution {
    public int shipWithinDays(int[] weights, int days) {
        int max = IntStream.of(weights)
                .max()
                .orElseThrow();
        int sum = IntStream.of(weights)
                .sum();

        int lowerBound = max;
        int upperBound = sum;
        int middle = (lowerBound + upperBound) / 2;
        boolean isPossible = checkDaysForCapacity(middle, weights, days);

        while (lowerBound < upperBound) {
            if (isPossible) {
                upperBound = middle;
            } else {
                lowerBound = middle + 1;
            }
            middle = (lowerBound + upperBound) / 2;
            isPossible = checkDaysForCapacity(middle, weights, days);
        }

        return middle;
    }

    private boolean checkDaysForCapacity(int capacity, int[] weights, int days) {
        int daysLeft = days;
        int currentCapacity = 0;
        for (int weight : weights) {
            int next = currentCapacity + weight;
            if (next > capacity) {
                daysLeft--;
                currentCapacity = weight;
            } else if (next == capacity) {
                daysLeft--;
                currentCapacity = 0;
            } else {
                currentCapacity = next;
            }
        }

        daysLeft = currentCapacity > 0 ? daysLeft - 1 : daysLeft;
        return daysLeft >= 0;
    }

    public static void main(String[] args) {
        Solution solution = new Solution();
        System.out.println(solution.shipWithinDays(new int[]{1, 2, 3, 4, 5, 6, 7, 8, 9, 10}, 5));
        System.out.println(solution.shipWithinDays(new int[]{3, 2, 2, 4, 1, 4}, 3));
        System.out.println(solution.shipWithinDays(new int[]{1, 2, 3, 1, 1}, 4));
        System.out.println(solution.shipWithinDays(new int[]{10, 50, 100, 100, 50, 100, 100, 100}, 5));
        System.out.println(solution.shipWithinDays(new int[]{1, 2, 3, 4, 5, 6, 7, 8, 9, 10}, 1));
        System.out.println(solution.shipWithinDays(new int[]{
                376, 80, 176, 64, 421, 250, 163, 252, 490, 229,
                408, 179, 106, 185, 108, 483, 349, 206, 76, 127,
                112, 384, 170, 125, 52, 111, 457, 326, 387, 140,
                9, 205, 462, 453, 464, 464, 89, 17, 362, 290, 102,
                278, 462, 343, 69, 430, 19, 476, 461, 270, 180, 148,
                454, 422, 460, 20, 150, 271, 143, 491, 120, 111, 291,
                383, 364, 101, 100, 38, 9, 306, 185, 326, 189, 325, 372,
                74, 329, 240, 114, 154, 6, 257, 172, 355, 337, 186, 87,
                377, 391, 453, 309, 47, 234, 257, 434, 338, 418, 207,
                176, 403, 497, 201, 147, 164, 92, 451, 211, 135, 28, 73,
                25, 223, 134, 418, 481, 81, 191, 268, 146, 452, 177, 158,
                8, 169, 208, 149, 325, 472, 141, 423, 197, 241, 250, 423,
                139, 101, 264, 94, 73, 454, 160, 256, 204, 354, 103, 281, 425,
                413, 158, 93, 477, 330, 183, 285, 335, 370, 146, 135, 440, 496,
                264, 97, 474, 190, 307, 142, 202, 95, 92, 56, 152, 108, 12, 109
                , 247, 191, 8, 11, 398, 279, 1, 240, 129, 349, 301, 482, 194,
                164, 424, 43, 420, 355, 355, 294, 203, 485, 141, 124, 98, 128,
                333, 85, 19, 39, 221, 329, 155, 207, 270, 191, 416, 395,
                61, 85, 357, 400, 143, 337, 445, 177, 98, 150, 112, 195,
                319, 21, 488, 407, 130, 133, 398, 55, 433, 307, 303, 297,
                381, 234, 287, 257, 347, 25, 237, 5, 325, 112, 285, 132,
                318, 427, 421, 448, 65, 259, 304, 78, 327, 490, 166, 27,
                256, 139, 294, 361, 42, 52, 95, 122, 422, 442, 271,
                441, 133, 397, 375, 186, 464, 314, 453, 183,
                425, 431, 241, 22, 80, 490, 476, 232, 359, 65,
                288, 361, 218, 480, 290, 389, 243, 343, 427,
                404, 87, 149, 208, 479, 243, 312, 185, 469, 421,
                305, 466, 335, 332, 117, 265, 409, 199, 47, 317,
                355, 267, 279, 6, 429, 404, 211, 167, 75, 384,
                360, 287, 137, 453, 361, 152, 283, 46, 208,
                195, 207, 405, 412, 354, 278, 464, 381, 333,
                487, 183, 311, 226, 225, 55, 451, 461, 263,
                143, 160, 212, 451, 250, 296, 155, 424, 114,
                296, 125, 470, 284, 443, 430, 494, 238, 144,
                176, 180, 91, 500, 10, 339, 379, 189, 375, 388,
                492, 461, 267, 104, 334, 167, 53, 93, 500, 445,
                196, 89, 72, 409, 395, 415, 219, 157, 161, 88,
                71, 98, 361, 31, 387, 216, 182, 110, 362, 437,
                452, 495, 409, 74, 442, 3, 229, 197, 191, 78,
                206, 69, 133, 217, 278, 436, 112, 11, 354, 496,
                88, 164, 256, 103, 126, 293, 292, 20, 355, 458,
                227, 467, 170, 431, 70, 404, 421, 56, 144, 73, 148,
                105, 328, 51, 134, 426, 80, 18, 118, 440, 194, 158,
                323, 366, 313, 162, 500, 297, 448, 217, 49, 333,
                499, 124, 280, 230, 476, 73, 337, 487, 271, 499,
                498, 98, 331, 76, 408, 338, 159, 154, 104, 208,
                185, 250, 98, 479, 171, 360, 150, 112, 305, 177,
                454, 102, 212, 43, 302, 123, 418, 124, 12, 133,
                339, 244, 380, 254, 318, 107, 277, 149, 58,
                268, 378, 98, 337, 56, 130, 470, 393, 459,
                177, 468, 142, 498, 140, 490, 189, 380, 20,
                338, 452, 330, 376, 409, 279, 50, 311, 219,
                373, 312, 383, 105, 25, 268, 21, 278, 13,
                181, 370, 191, 131, 233, 123, 375, 419, 403,
                466, 11, 438, 91, 71, 455, 122, 382, 468, 479,
                328, 135, 5, 467, 448, 311, 497, 400, 260, 310,
                427, 349, 182, 152, 7, 62, 133, 225, 354, 40,
                100, 313, 289, 195, 392, 249, 318, 287, 457, 387,
                361, 136, 460, 243, 236, 50, 412, 440, 124, 93,
                376, 95, 350, 430, 390, 149, 203, 440, 252, 32,
                461, 300, 426, 170, 495, 217, 269, 57, 257, 105,
                179, 380, 301, 58, 325, 440, 144, 102, 455, 352,
                455, 80, 300, 370, 58, 393, 239, 380, 104, 364,
                467, 136, 296, 169, 364, 224, 394, 338, 39, 319,
                428, 81, 194, 314, 370, 143, 162, 472, 415, 149,
                315, 318, 74, 258, 496, 475, 377, 346, 20, 14,
                417, 26, 362, 295, 388, 493, 370, 249, 13, 488,
                54, 195, 72, 263, 194, 155, 459, 250, 39, 210,
                455, 86, 340, 6, 105, 297, 196, 23, 217, 333, 434, 129
        }, 1));
        System.out.println(solution.shipWithinDays(new int[]{
                376, 80, 176, 64, 421, 250, 163, 252, 490, 229,
                408, 179, 106, 185, 108, 483, 349, 206, 76, 127,
                112, 384, 170, 125, 52, 111, 457, 326, 387, 140,
                9, 205, 462, 453, 464, 464, 89, 17, 362, 290, 102,
                278, 462, 343, 69, 430, 19, 476, 461, 270, 180, 148,
                454, 422, 460, 20, 150, 271, 143, 491, 120, 111, 291,
                383, 364, 101, 100, 38, 9, 306, 185, 326, 189, 325, 372,
                74, 329, 240, 114, 154, 6, 257, 172, 355, 337, 186, 87,
                377, 391, 453, 309, 47, 234, 257, 434, 338, 418, 207,
                176, 403, 497, 201, 147, 164, 92, 451, 211, 135, 28, 73,
                25, 223, 134, 418, 481, 81, 191, 268, 146, 452, 177, 158,
                8, 169, 208, 149, 325, 472, 141, 423, 197, 241, 250, 423,
                139, 101, 264, 94, 73, 454, 160, 256, 204, 354, 103, 281, 425,
                413, 158, 93, 477, 330, 183, 285, 335, 370, 146, 135, 440, 496,
                264, 97, 474, 190, 307, 142, 202, 95, 92, 56, 152, 108, 12, 109
                , 247, 191, 8, 11, 398, 279, 1, 240, 129, 349, 301, 482, 194,
                164, 424, 43, 420, 355, 355, 294, 203, 485, 141, 124, 98, 128,
                333, 85, 19, 39, 221, 329, 155, 207, 270, 191, 416, 395,
                61, 85, 357, 400, 143, 337, 445, 177, 98, 150, 112, 195,
                319, 21, 488, 407, 130, 133, 398, 55, 433, 307, 303, 297,
                381, 234, 287, 257, 347, 25, 237, 5, 325, 112, 285, 132,
                318, 427, 421, 448, 65, 259, 304, 78, 327, 490, 166, 27,
                256, 139, 294, 361, 42, 52, 95, 122, 422, 442, 271,
                441, 133, 397, 375, 186, 464, 314, 453, 183,
                425, 431, 241, 22, 80, 490, 476, 232, 359, 65,
                288, 361, 218, 480, 290, 389, 243, 343, 427,
                404, 87, 149, 208, 479, 243, 312, 185, 469, 421,
                305, 466, 335, 332, 117, 265, 409, 199, 47, 317,
                355, 267, 279, 6, 429, 404, 211, 167, 75, 384,
                360, 287, 137, 453, 361, 152, 283, 46, 208,
                195, 207, 405, 412, 354, 278, 464, 381, 333,
                487, 183, 311, 226, 225, 55, 451, 461, 263,
                143, 160, 212, 451, 250, 296, 155, 424, 114,
                296, 125, 470, 284, 443, 430, 494, 238, 144,
                176, 180, 91, 500, 10, 339, 379, 189, 375, 388,
                492, 461, 267, 104, 334, 167, 53, 93, 500, 445,
                196, 89, 72, 409, 395, 415, 219, 157, 161, 88,
                71, 98, 361, 31, 387, 216, 182, 110, 362, 437,
                452, 495, 409, 74, 442, 3, 229, 197, 191, 78,
                206, 69, 133, 217, 278, 436, 112, 11, 354, 496,
                88, 164, 256, 103, 126, 293, 292, 20, 355, 458,
                227, 467, 170, 431, 70, 404, 421, 56, 144, 73, 148,
                105, 328, 51, 134, 426, 80, 18, 118, 440, 194, 158,
                323, 366, 313, 162, 500, 297, 448, 217, 49, 333,
                499, 124, 280, 230, 476, 73, 337, 487, 271, 499,
                498, 98, 331, 76, 408, 338, 159, 154, 104, 208,
                185, 250, 98, 479, 171, 360, 150, 112, 305, 177,
                454, 102, 212, 43, 302, 123, 418, 124, 12, 133,
                339, 244, 380, 254, 318, 107, 277, 149, 58,
                268, 378, 98, 337, 56, 130, 470, 393, 459,
                177, 468, 142, 498, 140, 490, 189, 380, 20,
                338, 452, 330, 376, 409, 279, 50, 311, 219,
                373, 312, 383, 105, 25, 268, 21, 278, 13,
                181, 370, 191, 131, 233, 123, 375, 419, 403,
                466, 11, 438, 91, 71, 455, 122, 382, 468, 479,
                328, 135, 5, 467, 448, 311, 497, 400, 260, 310,
                427, 349, 182, 152, 7, 62, 133, 225, 354, 40,
                100, 313, 289, 195, 392, 249, 318, 287, 457, 387,
                361, 136, 460, 243, 236, 50, 412, 440, 124, 93,
                376, 95, 350, 430, 390, 149, 203, 440, 252, 32,
                461, 300, 426, 170, 495, 217, 269, 57, 257, 105,
                179, 380, 301, 58, 325, 440, 144, 102, 455, 352,
                455, 80, 300, 370, 58, 393, 239, 380, 104, 364,
                467, 136, 296, 169, 364, 224, 394, 338, 39, 319,
                428, 81, 194, 314, 370, 143, 162, 472, 415, 149,
                315, 318, 74, 258, 496, 475, 377, 346, 20, 14,
                417, 26, 362, 295, 388, 493, 370, 249, 13, 488,
                54, 195, 72, 263, 194, 155, 459, 250, 39, 210,
                455, 86, 340, 6, 105, 297, 196, 23, 217, 333, 434, 129
        }, 361));
        System.out.println(solution.shipWithinDays(new int[]{
                147, 73, 265, 305, 191, 152, 192, 293, 309,
                292, 182, 157, 381, 287, 73, 162, 313, 366,
                346, 47
        }, 10));
        System.out.println(solution.shipWithinDays(IntStream.range(0, 502).map(i -> 500).toArray(), 1));
        System.out.println(solution.shipWithinDays(new int[]{
                135, 49, 196, 105, 196, 161, 398, 69, 500, 257, 59, 108, 271,
                154, 73, 213, 497, 175, 222, 107, 254, 344, 47, 105, 35, 294,
                340, 123, 328, 347, 270, 74, 493, 402, 347, 488, 321, 271,
                398, 133, 82, 353, 20, 147, 127, 382, 68, 251, 400, 399,
                108, 38, 277, 488, 226, 134, 11, 137, 108, 289, 169, 384,
                476, 221, 33, 104, 85, 38, 473, 465, 424, 138, 126, 257,
                271, 94, 349, 41, 278, 262, 329, 86, 481, 85, 138, 129, 35,
                38, 108, 119, 402, 28, 113, 442, 121, 431, 439, 246, 493,
                398, 387, 120, 144, 338, 301, 310, 397, 417, 445, 493, 494,
                345, 380, 22, 60, 220, 185, 390, 126, 95, 236, 42, 79, 148,
                106, 176, 380, 318, 403, 60, 439, 393, 179, 251, 146, 331,
                58, 195, 489, 93, 92, 121, 16, 272, 85, 186, 157, 308, 430,
                375, 344, 468, 306, 57, 362, 471, 346, 378, 285, 161, 406,
                166, 443, 449, 97, 394, 207, 184, 401, 469, 399, 320, 365,
                338, 288, 123, 245, 179, 213, 23, 478, 409, 144, 365, 187,
                249, 51, 15, 60, 140, 64, 45, 275, 376, 270, 292, 74, 458,
                322, 82, 179, 34, 403, 468, 396, 278, 418, 54, 247, 391,
                119, 39, 199, 302, 298, 19, 413, 276, 454, 295, 29, 303,
                158, 220, 114, 271, 495, 388, 141, 90, 283, 164, 410, 292,
                141, 280, 42, 371, 199, 470, 447, 16, 407, 412, 31, 332,
                426, 68, 262, 148, 228, 155, 275, 266, 170, 332, 267, 130,
                294, 317, 82, 10, 211, 89, 36, 394, 498, 325, 385, 8, 386,
                330, 150, 433, 313, 320, 362, 282, 273, 158, 429, 164, 96,
                196, 380, 365, 188, 472, 39, 141, 91, 281, 310, 470, 300,
                308, 204, 256, 209, 233, 99, 437, 103, 286, 315, 190, 121,
                269, 194, 369, 401, 41, 46, 429, 422, 269, 119, 1, 484, 240,
                489, 405, 115, 302, 251, 222, 300, 306, 327, 163, 106, 162,
                240, 179, 47, 35, 438, 52, 172, 342, 1, 87, 45, 79, 206, 38,
                386, 150, 8, 360, 55, 349, 457, 200, 37, 67, 51, 31, 478,
                21, 367, 482, 242, 416, 370, 193, 232, 227, 287, 494, 369,
                7, 330, 358, 442, 162, 60, 342, 293, 407, 300, 320, 160, 154,
                243, 108, 253, 301, 41, 28, 147, 220, 14, 57, 495, 389, 71, 231,
                172, 52, 290, 436, 12, 93, 73, 181, 493, 281, 28, 84, 309, 313,
                158, 20, 95, 439, 152, 129, 195, 366, 494, 289, 157, 475, 428,
                48, 359, 87, 302, 341, 63, 53, 484, 158, 170, 146, 251, 13, 467,
                452, 402, 305, 413, 223, 46, 157, 460, 188, 327, 421, 316, 160,
                192, 323, 134, 210, 167, 175, 97, 17, 47, 296, 179, 347, 320,
                333, 498, 268, 175, 248, 391, 308, 211, 351, 498, 373, 228,
                286, 376, 210, 36, 70, 59, 482, 413, 249, 246, 290, 397, 35,
                254, 315, 138, 435, 486, 229, 362, 124, 496, 183, 293, 352,
                266, 228, 13, 125, 173, 143, 309, 355, 298, 64, 107, 415, 128,
                177, 412, 447, 43, 322, 441, 203, 485, 325, 344, 38, 319, 155,
                151, 383, 92, 193, 57, 40, 314, 452, 282, 107, 91, 445, 364, 464,
                294, 234, 321, 144, 175, 259, 490, 433, 79, 466, 431, 415, 246,
                396, 156, 9, 58, 213, 346, 186, 302, 336, 123, 469, 65, 160, 406,
                317, 395, 144, 465, 353, 112, 188, 61, 30, 493, 398, 446, 63, 37,
                74, 379, 188, 469, 447, 10, 348, 384, 355, 51, 446, 11, 227, 132,
                453, 30, 232, 19, 436, 146, 431, 164, 419, 377, 251, 27, 195, 233,
                485, 23, 222, 85, 3, 486, 205, 122, 370, 223, 316, 251, 478, 266,
                382, 86, 54, 103, 202, 217, 409, 311, 439, 302, 47, 102, 41, 376,
                269, 223, 377, 495, 473, 188, 309, 195, 256, 415, 254, 306, 25,
                73, 384, 461, 133, 47, 98, 332, 346, 144, 495, 219, 226, 109, 478,
                29, 166, 38, 127, 17, 109, 482, 427, 460, 416, 18, 488, 360, 253,
                138, 447, 272, 285, 302, 5, 462, 188, 239, 202, 439, 357, 276, 53,
                243, 16, 122, 213, 430, 234, 132, 41, 88, 276, 207, 82, 18, 20, 331,
                472, 163, 362, 164, 437, 392, 485, 426, 5, 116, 252, 357, 163, 301,
                469, 14, 282, 301, 73, 56, 313, 449, 262, 360, 64, 262, 63, 402, 169,
                303, 380, 178, 372, 4, 64, 351, 494, 475, 341, 475, 90, 17, 279, 161,
                188, 181, 334, 134, 284, 81, 19, 77, 225, 235, 182, 71, 463, 189, 323,
                415, 48, 426, 333, 143, 12, 187, 458, 321, 25, 331, 126, 163, 167,
                496, 239, 240, 149, 311, 182, 144, 454, 247, 141, 284, 353, 55, 83,
                144, 46, 152, 347
        }, 20));
    }
}
